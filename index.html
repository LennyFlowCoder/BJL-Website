<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BJL Cinematic Universe</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        :root {
            --color-1: #ee7752;
            --color-2: #e73c7e;
            --color-3: #23a6d5;
            --color-4: #23d5ab;
        }

        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #fff;
            background: linear-gradient(-45deg, var(--color-1), var(--color-2), var(--color-3), var(--color-4));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .main-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            position: absolute;
            top: 0;
            left: 0;
            box-sizing: border-box;
            background: rgba(0, 0, 0, 0.2);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, #fff, #ddd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transition: all 0.5s ease;
            background-size: 200% 200%;
            background-position: 0% 50%;
        }
        .logo:hover {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            background-position: 100% 50%;
        }

        .header-controls { display: flex; align-items: center; gap: 1rem; }
        .view { display: none; width: 100%; }
        .view.active { display: block; }

        .auth-container, .main-content, .admin-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 20px 20px 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .glass-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 40px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 450px;
            box-sizing: border-box;
        }

        .glass-box:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px 0 rgba(0, 0, 0, 0.3);
        }
        .glass-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 75%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: skewX(-25deg);
            transition: left 0.8s ease-in-out;
        }
        .glass-box:hover::before {
            left: 120%;
        }
        
        h1, h2 { font-weight: 600; }

        .input-group { margin-bottom: 1rem; }
        .input-group label { display: block; margin-bottom: 0.5rem; }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }
        .input-group input::placeholder { color: rgba(255, 255, 255, 0.7); }
        .input-group input:focus {
            outline: none;
            border-color: var(--color-4);
            background: rgba(0, 0, 0, 0.3);
        }

        .btn {
            background: linear-gradient(45deg, var(--color-3), var(--color-4));
            color: #fff;
            border: none;
            border-radius: 50px;
            padding: 15px 40px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        .btn:active {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .btn-primary {
            background: linear-gradient(45deg, var(--color-2), var(--color-1));
        }
        .btn-secondary {
            background: transparent;
            border: 1px solid #fff;
        }
        .btn-link { background: none; color: #fff; text-decoration: underline; padding: 0; border: none; font-weight: 400; }

        .error { color: #ffc4c4; text-align: center; margin-top: 1rem; min-height: 20px; font-weight: 600; }
        .success { color: #c8ffc4; text-align: center; margin-top: 1rem; }

        .admin-section, .code-container {
            margin-bottom: 2rem;
            padding: 30px;
        }
        .user-item { background-color: rgba(0, 0, 0, 0.3); border-radius: 10px; }
        .film-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; width: 100%; max-width: 1200px; }
        .film-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        .film-card:hover { transform: translateY(-10px) scale(1.05); }
        .film-card img { width: 100%; height: auto; display: block; }
        .film-card .film-info { position: absolute; bottom: 0; width: 100%; box-sizing: border-box; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 1rem; color: #fff; opacity: 0; transition: opacity 0.3s ease; }
        .film-card:hover .film-info { opacity: 1; }
        
        .modal-content {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
            border-radius: 20px;
        }
        .modal { position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); display: none; justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .close-btn { position: absolute; top: 10px; right: 25px; color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-btn:hover { color: #fff; }
    </style>
</head>
<body>

    <header class="main-header">
        <a href="#" class="logo">BJL Cinematic Universe</a>
        <div id="header-controls" class="header-controls" style="display:none;">
            <span id="welcome-user"></span>
            <button id="logout-btn" class="btn btn-secondary">Logout</button>
        </div>
    </header>

    <main>
        <div id="auth-view" class="view active">
            <div class="auth-container">
                <div class="glass-box" id="auth-box-container">
                    <div id="login-box">
                        <h2 style="color: #fff;">Login</h2>
                        <form id="login-form">
                            <div class="input-group"><input type="email" id="login-email" required placeholder="E-Mail"></div>
                            <div class="input-group"><input type="password" id="login-password" required placeholder="Passwort"></div>
                            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Einloggen</button>
                            <p style="text-align: center; margin-top: 1rem;">Noch kein Konto? <a id="show-register" class="btn-link">Jetzt registrieren</a></p>
                        </form>
                    </div>
                    <div id="register-box" style="display:none;">
                        <h2 style="color: #fff;">Registrieren</h2>
                        <form id="register-form">
                            <div class="input-group"><input type="email" id="register-email" required placeholder="E-Mail"></div>
                            <div class="input-group"><input type="password" id="register-password" required placeholder="Passwort"></div>
                            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Registrieren</button>
                            <p style="text-align: center; margin-top: 1rem;">Bereits ein Konto? <a id="show-login" class="btn-link">Zum Login</a></p>
                        </form>
                    </div>
                    <p id="error-message" class="error"></p>
                </div>
            </div>
        </div>
        
        <div id="dashboard-view" class="view">
            <div class="main-content">
                <div id="code-entry-section" class="glass-box code-container">
                    <h2 style="color: #fff;">Zugangscode erforderlich</h2>
                    <p>Gib deinen 6-stelligen Zugangscode ein.</p>
                    <form id="code-form">
                        <div class="input-group"><input type="text" id="access-code" placeholder="XXXXXX" maxlength="6" required style="text-align: center; font-size: 1.5rem; letter-spacing: 0.5rem;"></div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Freischalten</button>
                    </form>
                    <p id="code-error" class="error"></p>
                    <button id="request-code-btn" class="btn btn-link" style="margin-top: 1rem;">Noch keinen Code? Jetzt anfordern</button>
                    <p id="request-message" class="success" style="display:none;">Deine Anfrage wurde gesendet.</p>
                </div>
                <div id="film-gallery-section" style="display:none; width: 100%; text-align: center;">
                    <h1 class="logo" style="margin-bottom: 2rem; font-size: 3rem;">Filmgalerie</h1>
                    <div id="film-grid" class="film-grid"></div>
                </div>
            </div>
        </div>

        <div id="admin-view" class="view">
             <div class="admin-container">
                <h1 class="logo" style="margin-bottom: 2rem; font-size: 3rem;">Admin Dashboard</h1>
                <div class="glass-box admin-section">
                    <h2>Code-Anfragen</h2>
                    <div id="code-requests-list" class="user-list"></div>
                </div>
                <div class="glass-box admin-section">
                    <h2>Neuen Film hochladen</h2>
                    <form id="upload-form">
                        <div class="input-group">
                            <input type="text" id="film-title" placeholder="Filmtitel" required>
                        </div>
                        <div class="input-group">
                            <textarea id="film-description" placeholder="Filmbeschreibung" required style="background: rgba(0,0,0,0.2); border-radius:10px;"></textarea>
                        </div>
                        <div class="input-group">
                            <label>Coverbild:</label>
                            <input type="file" id="film-cover" accept="image/*" required>
                        </div>
                        <div class="input-group">
                            <label>Videodatei:</label>
                            <input type="file" id="film-video" accept="video/*" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width:100%">Film hochladen</button>
                        <p id="upload-success" class="success" style="display:none;">Film erfolgreich hochgeladen!</p>
                    </form>
                </div>
                <div class="glass-box admin-section">
                    <h2>Benutzerübersicht</h2>
                    <div id="user-list" class="user-list"></div>
                </div>
            </div>
        </div>
    </main>

    <div id="video-player-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <video id="video-player" width="100%" controls controlslist="nodownload" oncontextmenu="return false;"></video>
            <h3 id="video-title" style="color: #fff; margin-top: 15px;"></h3>
            <p id="video-description"></p>
        </div>
    </div>


    <script>
        // Haupt-Logik startet hier
        document.addEventListener('DOMContentLoaded', () => {
            const app = new App();
            app.init();
        });

        class App {
            constructor() {
                this.auth = new Auth(this);
                this.codeManager = new CodeManager(this);
                this.filmManager = new FilmManager(this);
                this.uiManager = new UIManager();
                this.soundManager = new SoundManager();
            }

            init() {
                this.auth.init();
                this.codeManager.init();
                this.filmManager.init();
                this.soundManager.init();
                
                const currentUser = this.auth.getCurrentUser();
                if (currentUser) {
                    this.showDashboard(currentUser);
                } else {
                    this.uiManager.showView('auth');
                }
            }
            
            showDashboard(user) {
                this.uiManager.showLoggedInHeader(user.email);
                if (user.email === 'bjl.cinematicuniverse@gmail.com') {
                    this.uiManager.showView('admin');
                    this.codeManager.displayCodeRequests();
                    this.codeManager.displayAllUsers();
                } else {
                    this.uiManager.showView('dashboard');
                    document.getElementById('code-entry-section').style.display = 'block';
                    document.getElementById('film-gallery-section').style.display = 'none';
                    document.getElementById('code-error').textContent = '';
                    document.getElementById('access-code').value = '';
                }
            }

            logout() {
                this.auth.logout();
                this.uiManager.showLoggedOutHeader();
                this.uiManager.showView('auth');
            }
        }
        
        class SoundManager {
            constructor() {
                this.hoverSound = new Audio('assets/hover.mp3'); 
                this.clickSound = new Audio('assets/click.mp3');
                this.hoverSound.volume = 0.3;
                this.clickSound.volume = 0.5;
            }
            
            init() {
                const buttons = document.querySelectorAll('.btn, .film-card, .close-btn, a');
                buttons.forEach(button => {
                    button.addEventListener('mouseenter', () => {
                        this.hoverSound.currentTime = 0;
                        this.hoverSound.play().catch(e => {});
                    });
                    button.addEventListener('click', () => {
                        this.clickSound.currentTime = 0;
                        this.clickSound.play().catch(e => {});
                    });
                });
            }
        }
        
        class UIManager {
            constructor() {
                this.views = document.querySelectorAll('.view');
                this.headerControls = document.getElementById('header-controls');
                this.welcomeUser = document.getElementById('welcome-user');
            }
            showView(viewId) {
                this.views.forEach(view => {
                    view.classList.remove('active');
                    if (view.id === `${viewId}-view`) view.classList.add('active');
                });
            }
            showLoggedInHeader(email) {
                this.headerControls.style.display = 'flex';
                this.welcomeUser.textContent = `Willkommen, ${email}`;
            }
            showLoggedOutHeader() {
                this.headerControls.style.display = 'none';
            }
        }

        class Auth {
            constructor(app) {
                this.app = app;
                this.users = JSON.parse(localStorage.getItem('users')) || [];
                if (!this.users.find(u => u.email === 'bjl.cinematicuniverse@gmail.com')) {
                    this.users.push({ email: 'bjl.cinematicuniverse@gmail.com', password: 'admin' });
                    this._saveUsers();
                }
            }
            init() {
                document.getElementById('login-form').addEventListener('submit', e => { e.preventDefault(); this.login(); });
                document.getElementById('register-form').addEventListener('submit', e => { e.preventDefault(); this.register(); });
                document.getElementById('show-register').addEventListener('click', () => this._toggleAuthForms(true));
                document.getElementById('show-login').addEventListener('click', () => this._toggleAuthForms(false));
                document.getElementById('logout-btn').addEventListener('click', () => this.app.logout());
            }
            _saveUsers() { localStorage.setItem('users', JSON.stringify(this.users)); }
            _toggleAuthForms(showRegister) {
                document.getElementById('login-box').style.display = showRegister ? 'none' : 'block';
                document.getElementById('register-box').style.display = showRegister ? 'block' : 'none';
                document.getElementById('error-message').textContent = '';
            }
            register() {
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                if (this.users.find(user => user.email === email)) {
                    document.getElementById('error-message').textContent = 'E-Mail bereits registriert.';
                    return;
                }
                this.users.push({ email, password });
                this._saveUsers();
                alert('Registrierung erfolgreich! Bitte einloggen.');
                this._toggleAuthForms(false);
                document.getElementById('register-form').reset();
            }
            login() {
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                const user = this.users.find(u => u.email === email && u.password === password);
                if (user) {
                    const userIndex = this.users.findIndex(u => u.email === email);
                    this.users[userIndex].lastLogin = new Date().toISOString();
                    this._saveUsers();
                    localStorage.setItem('currentUser', JSON.stringify({ email: user.email }));
                    this.app.showDashboard({ email: user.email });
                } else {
                    document.getElementById('error-message').textContent = 'Ungültige E-Mail oder Passwort.';
                }
            }
            logout() { localStorage.removeItem('currentUser'); }
            getCurrentUser() { return JSON.parse(localStorage.getItem('currentUser')); }
            getAllUsers() { return this.users; }
        }

        class CodeManager {
            constructor(app) {
                this.app = app;
                this.codes = JSON.parse(localStorage.getItem('codes')) || [];
                this.codeRequests = JSON.parse(localStorage.getItem('codeRequests')) || [];
            }
            init() {
                document.getElementById('request-code-btn').addEventListener('click', () => this.requestAccessCode());
                document.getElementById('code-form').addEventListener('submit', e => { e.preventDefault(); this.validateCode(); });
            }
            _saveData() {
                localStorage.setItem('codes', JSON.stringify(this.codes));
                localStorage.setItem('codeRequests', JSON.stringify(this.codeRequests));
            }
            requestAccessCode() {
                const currentUser = this.app.auth.getCurrentUser();
                if (!currentUser) return;
                if (this.codeRequests.includes(currentUser.email)) {
                    alert('Du hast bereits einen Code angefordert.');
                    return;
                }
                this.codeRequests.push(currentUser.email);
                this._saveData();
                document.getElementById('request-message').style.display = 'block';
            }
            validateCode() {
                const codeInput = document.getElementById('access-code').value;
                const currentUser = this.app.auth.getCurrentUser();
                const codeError = document.getElementById('code-error');
                codeError.textContent = '';
                const codeIndex = this.codes.findIndex(c => c.code === codeInput && c.user === currentUser.email);

                if (codeIndex === -1) {
                    codeError.textContent = 'Dieser Code ist ungültig.';
                    return;
                }
                const codeObject = this.codes[codeIndex];
                if (codeObject.isUsed) {
                    codeError.textContent = 'Dieser Code wurde bereits eingelöst.';
                    return;
                }
                this.codes[codeIndex].isUsed = true;
                this._saveData();
                document.getElementById('code-entry-section').style.display = 'none';
                document.getElementById('film-gallery-section').style.display = 'block';
                this.app.filmManager.loadFilmGallery();
            }
            displayCodeRequests() {
                const listElement = document.getElementById('code-requests-list');
                listElement.innerHTML = this.codeRequests.length === 0 ? '<p>Keine offenen Anfragen.</p>' : '';
                this.codeRequests.forEach(email => {
                    const item = document.createElement('div');
                    item.className = 'user-item';
                    item.innerHTML = `<span>${email}</span><button class="btn btn-primary btn-sm">Code erstellen</button>`;
                    item.querySelector('button').addEventListener('click', () => this.generateAndSendCode(email));
                    listElement.appendChild(item);
                });
            }
            generateAndSendCode(email) {
                const newCode = Math.floor(100000 + Math.random() * 900000).toString();
                this.codes.push({ code: newCode, user: email, isUsed: false, createdAt: new Date().toISOString() });
                this.codeRequests = this.codeRequests.filter(reqEmail => reqEmail !== email);
                this._saveData();
                sendCodeByEmail(email, newCode);
                this.displayCodeRequests();
            }
            displayAllUsers() {
                const listElement = document.getElementById('user-list');
                listElement.innerHTML = '';
                this.app.auth.getAllUsers().forEach(user => {
                    if (user.email === 'bjl.cinematicuniverse@gmail.com') return;
                    const lastLogin = user.lastLogin ? new Date(user.lastLogin).toLocaleString('de-DE') : 'Nie';
                    const item = document.createElement('div');
                    item.className = 'user-item';
                    item.innerHTML = `<span><strong>E-Mail:</strong> ${user.email}</span><span><strong>Login:</strong> ${lastLogin}</span>`;
                    listElement.appendChild(item);
                });
            }
        }
        
        class FilmManager {
            constructor(app) {
                this.app = app;
                this.films = JSON.parse(localStorage.getItem('films')) || [];
            }

            // KORRIGIERT: VEREINFACHTE INIT-FUNKTION OHNE DRAG & DROP
            init() {
                const uploadForm = document.getElementById('upload-form');
                if (!uploadForm) return;
                
                uploadForm.addEventListener('submit', e => {
                    e.preventDefault();
                    this.uploadFilm();
                });
                
                document.querySelector('.close-btn').onclick = () => this.hideVideoPlayer();
                document.getElementById('video-player-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'video-player-modal') this.hideVideoPlayer();
                });
            }

            _saveFilms() {
                localStorage.setItem('films', JSON.stringify(this.films));
            }

            async uploadFilm() {
                const CLOUD_NAME = "dgsfozqb7"; 
                const UPLOAD_PRESET = "pkd40q5y";

                const title = document.getElementById('film-title').value;
                const description = document.getElementById('film-description').value;
                const coverFile = document.getElementById('film-cover').files[0];
                const videoFile = document.getElementById('film-video').files[0];
                const uploadButton = document.querySelector('#upload-form button[type="submit"]');

                if (!title || !description || !coverFile || !videoFile) {
                    alert('Bitte alle Felder ausfüllen.');
                    return;
                }

                if (CLOUD_NAME === "dgsfozqb7" || UPLOAD_PRESET === "pkd40q5y") {
                    alert("Bitte trage zuerst deinen Cloudinary Cloud Name und Upload Preset Namen im Skript ein!");
                    return;
                }

                uploadButton.disabled = true;
                uploadButton.textContent = 'Lade hoch...';

                try {
                    const uploadFileToCloudinary = async (file, resourceType) => {
                        const formData = new FormData();
                        formData.append('file', file);
                        formData.append('upload_preset', UPLOAD_PRESET);

                        const url = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/${resourceType}/upload`;
                        
                        const response = await fetch(url, {
                            method: 'POST',
                            body: formData,
                        });

                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(`Cloudinary Upload fehlgeschlagen: ${errorData.error.message}`);
                        }

                        const data = await response.json();
                        return data.secure_url;
                    };

                    uploadButton.textContent = 'Lade Cover hoch...';
                    const coverURL = await uploadFileToCloudinary(coverFile, 'image');
                    
                    uploadButton.textContent = 'Lade Video hoch...';
                    const videoURL = await uploadFileToCloudinary(videoFile, 'video');

                    const newFilm = {
                        id: Date.now(),
                        title,
                        description,
                        cover: coverURL,
                        video: videoURL
                    };

                    this.films.push(newFilm);
                    this._saveFilms();

                    const successMsg = document.getElementById('upload-success');
                    successMsg.style.display = 'block';
                    document.getElementById('upload-form').reset();
                    setTimeout(() => { successMsg.style.display = 'none'; }, 3000);

                } catch (error) {
                    console.error("Upload-Fehler:", error);
                    alert(`Ein Fehler ist beim Hochladen aufgetreten: ${error.message}`);
                } finally {
                    uploadButton.disabled = false;
                    uploadButton.textContent = 'Film hochladen';
                }
            }

            loadFilmGallery() {
                const filmGrid = document.getElementById('film-grid');
                filmGrid.innerHTML = '';
                const currentFilms = JSON.parse(localStorage.getItem('films')) || [];

                if (currentFilms.length === 0) {
                    filmGrid.innerHTML = '<p>Keine Filme verfügbar.</p>';
                    return;
                }
                
                currentFilms.forEach(film => {
                    const filmCard = document.createElement('div');
                    filmCard.className = 'film-card';
                    filmCard.innerHTML = `<img src="${film.cover}" alt="${film.title}"><div class="film-info"><h3>${film.title}</h3></div>`;
                    filmCard.addEventListener('click', () => this.showVideoPlayer(film));
                    filmGrid.appendChild(filmCard);
                });
            }
            
            showVideoPlayer(film) {
                const modal = document.getElementById('video-player-modal');
                document.getElementById('video-player').src = film.video;
                document.getElementById('video-title').textContent = film.title;
                document.getElementById('video-description').textContent = film.description;
                modal.classList.add('active');
            }

            hideVideoPlayer() {
                const modal = document.getElementById('video-player-modal');
                modal.classList.remove('active');
                document.getElementById('video-player').pause();
                document.getElementById('video-player').src = "";
            }
        }
        
        function sendCodeByEmail(userEmail, accessCode) {
            const publicKey = 'NeKfQ5FAdlyo2prm9', serviceID = 'service_783ypuq', templateID = 'template_ed0rm88';
            if (serviceID.startsWith('DEIN_')) {
                console.warn(`EmailJS ist nicht konfiguriert.`);
                alert(`E-Mail-Versand nicht konfiguriert. Code für ${userEmail}: ${accessCode}`);
                return;
            }
            emailjs.init(publicKey);
            const templateParams = { to_email: userEmail, access_code: accessCode, from_name: 'BJL Cinematic Universe' };
            emailjs.send(serviceID, templateID, templateParams)
                .then(res => alert(`E-Mail erfolgreich an ${userEmail} gesendet.`))
                .catch(err => {
                    console.error('Fehler:', err);
                    alert('FEHLER: E-Mail konnte nicht gesendet werden.');
                });
        }
    </script>
</body>
</html>
